<%- include header.ejs %>

<main>
    <div class="container">
        <h4 class="cc-corporate-blue-text">Editar perfil</h4>
        <div class="row">
            <div class="col l4 m4 s4" align="center">
                <% if (user.picture) { %>
                <img class="responsive-img" src="<%= user.picture %>">
                <% } else { %>
                <img class="responsive-img" src="/img/silueta.png">
                <p>Actualiza tu foto para que tus alumnos puedan saber algo más sobre ti</p>
                <% } %>
                <div>
                    <a href="#modal_upload_picture" class="btn">Cambiar imagen</a>
                </div>
            </div>
            <br>
            <form method="post" action="" id="edit">
                <div class="col l8 m8 s12">
                    <a href="/user/update"><h5><i class="material-icons">settings</i> Cambiar información de acceso a la cuenta</h5></a>
                </div>
                <div class="col l8 m8 s12">
                    <div class="row">
                        <% if (user.role == 1) { %>
                        <div class="input-field col l6 m6 s12">
                            <input type="text" name="firstname" id="firstname" value="<%= teacher.firstName %>" required />
                            <label for="firstname">Nombre</label>
                        </div>
                        <div class="input-field col l6 m6 s12">
                            <input type="text" name="lastname" id="lastname" value="<%= teacher.lastName %>" required />
                            <label for="lastname">Apellido</label>
                        </div>
                        <% } else { %>
                        <div class="input-field col l6 m6 s12">
                            <h6 class="red-text">Solo Curso Club puede modificar este campo</h6>
                            <input type="text" name="firstname" id="firstname" value="<%= teacher.firstName %>" readonly required />
                            <label for="firstname">Nombre</label>
                        </div>
                        <div class="input-field col l6 m6 s12">
                            <h6 class="red-text">Solo Curso Club puede modificar este campo</h6>
                            <input type="text" name="lastname" id="lastname" value="<%= teacher.lastName %>" readonly required />
                            <label for="lastname">Apellido</label>
                        </div>
                        <% } %>
                        <div class="input-field col l6 m6 s12">
                            <% if (user.role == 1) { %>
                            <input type="text" name="document" id="document" value="<%= teacher.document %>" required/>
                            <% } else {%>
                            <h6 class="red-text">Solo Curso Club puede modificar este campo</h6>
                            <input type="text" name="document" id="document" value="<%= teacher.document %>" required readonly/>
                            <% } %>
                            <label for="document">Cédula de ciudadanía</label>
                        </div>
                        <div class="input-field col l6 m6 s12">
                            <input class="datepicker" type="date" name="birthday" id="birthday" placeholder="Fecha de nacimiento" value="<%= birthdayString %>" required />
                            <label for="birthday">Fecha de nacimiento</label>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col l6 m6 s12">
                        <input type="text" name="address" id="address" value="<%= teacher.address %>" required />
                        <label for="address">Dirección</label>
                    </div>
                    <div class="input-field col l6 m6 s12">
                        <input type="text" name="workingArea" id="workingArea" value="<%= teacher.workingArea %>" required>
                        <label for="workingArea">Área de trabajo</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col l6 m6 s12">
                        <input type="text" name="phone" id="phone" value="<%= teacher.phone %>" required />
                        <label for="phone">Teléfono</label>
                    </div>
                </div>
                <div class="row">
                    <p>Clases grupales</p>
                    <div class="input-field col s4 m4 l4">
                        <div class="switch">
                            <label>
                                Desactivadas
                                <% if (teacher.groupLesson.does) { %>
                                <input name="groupDoes" id="groupDoes_switch" type="checkbox" value="true" checked>
                                <% } else { %>
                                <input name="groupDoes" id="groupDoes_switch" type="checkbox" value="true">
                                <% } %>
                                <span class="lever"></span>
                                Activadas
                            </label>
                        </div>
                    </div>
                    <div class="input-field col s4 m4 l4">
                        <input type="number" name="maxStudents" id="maxStudents" value="<%= teacher.groupLesson.maxStudents %>" class="validate">
                        <label for="maxStudents">Número máximo de alumnos</label>
                    </div>
                    <div class="input-field col s4 m4 l4">
                        <input type="number" name="discountPerStudent" id="discountPerStudent" value="<%= teacher.groupLesson.discountPerStudent %>" class="validate">
                        <label for="discountPerStudent">Porcentaje de descuento por cada estudiante</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <textarea id="description" name="description" class="materialize-textarea"><%= teacher.description %></textarea>
                        <label for="description">Descripción</label>
                    </div>
                </div>
                <% if (user.role == 1) { %>
                    <% for (var i=0; i<courses_list.length; i++) { %>
                        <% if (teacher_courses_list.indexOf(courses_list[i].id) > -1) { %>
                <div class="row">
                    <div class="input-field col s3">
                        <input type="checkbox" name="course" id="<%= 'course'+courses_list[i].id %>" value="<%= courses_list[i].id %>" checked />
                        <label for="<%= 'course'+courses_list[i].id %>"><%= courses_list[i].name %></label>
                    </div>
                    <div class="input-field col s9">
                        <input type="text" name="<%= 'price'+courses_list[i].id %>" id="<%= 'course_price'+courses_list[i].id %>" value="<%= teacher_courses_list_pricePerHour[teacher_courses_list.indexOf(courses_list[i].id)] %>" />
                        <label for="<%= 'price'+courses_list[i].id %>">Precio por hora de clase</label>
                    </div>
                </div>
                        <% } else { %>
                <div class="row">
                    <div class="input-field col s3">
                        <input type="checkbox" name="course" id="<%= 'course'+courses_list[i].id %>" value="<%= courses_list[i].id %>" />
                        <label for="<%= 'course'+courses_list[i].id %>"><%= courses_list[i].name %></label>
                    </div>
                    <div class="input-field col s9">
                        <input type="text" name="<%= 'price'+courses_list[i].id %>" id="<%= 'course_price'+courses_list[i].id %>" />
                        <label for="<%= 'price'+courses_list[i].id %>">Precio por hora de clase</label>
                    </div>
                </div>
                        <% } %>
                    <% } %>
                <% } else { %>
                    <% for (var i=0; i<teacher.courses.length; i++) { %>
                <input type="hidden" name="course" id="<%= 'course'+teacher.courses[i] %>" value="<%= teacher.courses[i] %>">
                <input type="hidden" name="<%= 'price'+teacher.courses[i] %>" id="<%= 'course_price'+teacher.courses[i] %>" value="<%= teacher.getPriceOfCourse(teacher.courses[i]) %>" />
                    <% } %>
                <% } %>
                <button class="waves-effect waves-light btn blue" type="submit" value="Aceptar" >Aceptar</button>
            </form>
        </div>
    </div>
    <div class="modal" id="modal_upload_picture">
        <form method="post" action="/user/<%= user.id %>/uploadPicture" enctype="multipart/form-data">
            <div class="modal-content">
                <div class="row">
                    <div class="col l6 m6 s6">
                        <h6>Imagen actual</h6>
                        <% if (user.picture) { %>
                        <img class="responsive-img cc-edit-user-picture-modal" src="<%= user.picture %>">
                        <% } else { %>
                        <img class="responsive-img" src="/img/silueta.png">
                        <p>Actualiza tu foto para que tus alumnos puedan saber algo más sobre ti</p>
                        <% } %>
                    </div>
                    <div class="col l6 m6 s6">
                        <h6>Nueva imagen</h6>
                        <output id="new-image"></output>
                        <div id="new-image-info"></div>
                    </div>
                </div>
                <input type="hidden" name="userId" value="<%= user.id %>">
                <div class="input-field file-field">
                    <div class="btn indigo">
                        <span>Elegir archivo</span>
                        <input type="file" name="picture" id="picture-input">
                    </div>
                    <div class="file-path-wrapper">
                        <input class="file-path" id="file-name" type="text" placeholder="Imágen con tamaño no mayor a 6 mb">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="submit-upload" class="btn cc-corporate-blue" type="submit" disabled>Subir imagen</button>
                <a href="#!" class="modal-action modal-close btn-flat">Cancelar</a>
            </div>
        </form>
    </div>
</main>
<script type="text/javascript" src="/js/uploadFileManager.js"></script>

<%- include footer.ejs %>